<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>JournÃ©e Sans Nous â€” GÃ©nÃ©rateur de mails aux syndicats</title>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" />
  <style>
    :root{--brand:#ee4943;--brand-600:#d33e38;--ink:#0f172a;--muted:#475569;--line:#e5e7eb;--radius:16px}
    *{box-sizing:border-box}
    body{margin:0;font:16px/1.6 'Manrope',sans-serif;color:var(--ink);background:#fff}
    a{color:var(--brand);text-decoration:none}

    header{position:sticky;top:0;z-index:50;background:#fff;border-bottom:1px solid var(--line)}
    .wrap{max-width:1100px;margin:auto;padding:0 18px}
    .topbar{display:flex;justify-content:space-between;align-items:center;height:64px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800;color:var(--brand)}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:#fff;color:var(--ink);cursor:pointer}
    .btn.primary{background:var(--brand);border-color:var(--brand-600);color:#fff}
    .btn.ghost{background:#fff}
    .btn:disabled{opacity:.6;cursor:not-allowed}

    .ticker{background:var(--brand);color:#fff;overflow:hidden;white-space:nowrap}
    .ticker .track{display:inline-block;animation:scroll 60s linear infinite;padding:6px 0}
    @keyframes scroll{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}

    .hero{background:linear-gradient(180deg,#fff 0%,#fff5f4 100%);padding:30px 0;border-bottom:1px solid var(--line)}
    h1{color:var(--brand);font-size:clamp(28px,3.2vw,42px);line-height:1.2;margin:0}
    .lede{color:var(--muted);margin:.4rem 0 0}

    main{max-width:1100px;margin:auto;padding:18px}
    .grid{display:grid;gap:16px}
    @media(min-width:900px){.grid{grid-template-columns:1.05fr .95fr}}

    .card{background:#fff;border:1px solid var(--line);border-radius:16px}
    .card-head{display:flex;justify-content:space-between;align-items:center;padding:14px 18px;border-bottom:1px solid var(--line)}
    .card-head h2{margin:0;color:var(--brand);font-size:18px}
    .card-body{padding:14px 18px}

    label{display:block;font-weight:600;margin:.3rem 0 .25rem}
    input,select,textarea{width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:#fff;outline:none}
    input:focus,select:focus,textarea:focus{border-color:#ffcabf;box-shadow:0 0 0 3px #ffe7e2}
    textarea{min-height:220px;resize:vertical}

    .two{display:grid;gap:12px}
    @media(min-width:680px){.two{grid-template-columns:1fr 1fr}}

    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .note{border-left:4px solid var(--brand);background:#fff2f1;padding:.8rem;border-radius:12px}

    .preview{white-space:pre-wrap;border:1px dashed var(--line);border-radius:12px;padding:12px;background:#fff7f6}

    .muted{color:#64748b;font-size:14px}

    footer{color:#64748b;text-align:center;padding:26px 0;border-top:1px solid var(--line);margin-top:18px}
  </style>
</head>
<body>
  <header>
    <div class="wrap topbar">
      <div class="brand"><i></i><span>JournÃ©e Sans Nous</span></div>
      <div style="display:flex;gap:10px;align-items:center">
        <a class="btn ghost" href="./index.html"><i class="fa-solid fa-arrow-left"></i> Retour au guide</a>
        <a class="btn primary" target="_blank" rel="noopener" href="https://mijnschatje.github.io/journeesansnous/"><i class="fa-solid fa-house"></i> Accueil</a>
      </div>
    </div>
  </header>

  <div class="ticker"><div class="track">EN RÃ‰GION PARISIENNE : lundi 17 novembre 19hâ€“21h âžœ AssemblÃ©e publique â€“ Bourse du Travail, 29 Bd du Temple, 75011 Paris â€¢ tous les lundis 19h âžœ RÃ©union dâ€™organisation â€“ 3 rue du ChÃ¢teau dâ€™Eau â€¢ Ã€ Lâ€™Ã‰CHELLE NATIONALE : jeudi 30 octobre 19hâ€“21h âžœ RÃ©union en visio nationale des collectifs signataires de lâ€™appel</div></div>

  <section class="hero">
    <div class="wrap">
      <h1>GÃ©nÃ©rateur de mails aux syndicats</h1>
      <p class="lede">MÃªme design que le guide. Choisis ton syndicat et ta section locale dans la base, personnalise, puis envoie.</p>
    </div>
  </section>

  <main>
    <div class="grid">
      <!-- FORMULAIRE -->
      <div class="card">
        <div class="card-head">
          <h2>1) Choisir les destinataires</h2>
          <button class="btn" id="btnPreavis"><i class="fa-solid fa-copy"></i> Copier le modÃ¨le de prÃ©avis</button>
        </div>
        <div class="card-body">
          <div class="two">
            <div>
              <label for="syndicat">Syndicat</label>
              <select id="syndicat"></select>
            </div>
            <div>
              <label for="structure">Section / Territoire</label>
              <select id="structure"></select>
            </div>
            <div>
              <label for="destinataire">Destinataire (email)</label>
              <input id="destinataire" type="email" placeholder="ex : contact@syndicat-xx.org" />
              <div class="muted">PrÃ©-rempli si trouvÃ© dans la base. Modifiable.</div>
            </div>
            <div>
              <label for="cc">Copie (CC optionnel)</label>
              <input id="cc" type="email" placeholder="ex : section.locale@â€¦" />
            </div>
            <div>
              <label for="nom">Nom / PrÃ©nom</label>
              <input id="nom" placeholder="Ton nom (ou collectif)" />
            </div>
            <div>
              <label for="lieu">Ville / Lieu de travail</label>
              <input id="lieu" placeholder="ex : Paris 20e, entrepÃ´t X, collÃ¨ge Yâ€¦" />
            </div>
          </div>

          <label for="sujet" style="margin-top:10px">Objet</label>
          <input id="sujet" value="Appel Ã  la mobilisation du 18 dÃ©cembre â€“ JournÃ©e Sans Nous : pour une grÃ¨ve solidaire et politique" />
        </div>
      </div>

      <!-- MESSAGE -->
      <div class="card">
        <div class="card-head">
          <h2>2) Personnaliser le message</h2>
          <div class="actions">
            <button class="btn" id="btnRemplir"><i class="fa-solid fa-wand-magic-sparkles"></i> Charger le modÃ¨le</button>
            <button class="btn" id="btnCopier"><i class="fa-solid fa-copy"></i> Copier</button>
            <button class="btn primary" id="btnApercu"><i class="fa-solid fa-eye"></i> AperÃ§u</button>
          </div>
        </div>
        <div class="card-body">
          <label for="message">Message (modÃ¨le officiel, modifiable)</label>
          <textarea id="message"></textarea>
          <div class="note" style="margin-top:10px">
            Ce modÃ¨le est celui fourni par la campagne. Tu peux lâ€™adapter (ajouter des infos locales, etc.).
          </div>
        </div>
      </div>

      <!-- APERÃ‡U & ENVOI -->
      <div class="card">
        <div class="card-head">
          <h2>3) VÃ©rifier & envoyer</h2>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <button class="btn" id="btnMailto"><i class="fa-solid fa-paper-plane"></i> Ouvrir dans mon mail</button>
            <button class="btn" id="btnTelecharger"><i class="fa-solid fa-file-arrow-down"></i> TÃ©lÃ©charger en .txt</button>
          </div>
        </div>
        <div class="card-body">
          <div id="preview" class="preview" aria-live="polite">Clique sur Â«Â Charger le modÃ¨leÂ Â», complÃ¨te les champs, puis vÃ©rifie ici avant envoi.</div>
        </div>
      </div>

      <!-- BASE D'EMAILS -->
      <div class="card">
        <div class="card-head">
          <h2>Base dâ€™emails (optionnelle)</h2>
          <div class="actions">
            <button class="btn" id="btnReload"><i class="fa-solid fa-rotate"></i> Recharger</button>
          </div>
        </div>
        <div class="card-body">
          <p class="muted">Ce gÃ©nÃ©rateur peut charger une base JSON locale `./data/emails-syndicats.json`. Sâ€™il nâ€™y en a pas, tu peux saisir lâ€™email Ã  la main.</p>
          <pre class="preview" style="font-size:12px">Format attendu :
{
  "CGT": {
    "national": "contact@cgt.fr",
    "sections": [
      {"label": "CGT Paris (75)", "email": "paris@cgt.fr"},
      {"label": "CGT Seine-Saint-Denis (93)", "email": "ud93@cgt.fr"}
    ]
  },
  "Solidaires": { "national": "contact@solidaires.org", "sections": [ ... ] }
}
          </pre>
        </div>
      </div>
    </div>
  </main>

  <footer><div class="wrap">Â© JournÃ©e Sans Nous â€” GÃ©nÃ©rateur de mails</div></footer>

  <script>
    const el = id => document.getElementById(id);

    // --- ModÃ¨le officiel du mail (issu de la campagne) ---
    const MODELE_OFFICIEL = () => {
      const nom  = (el('nom').value || '[PrÃ©nom Nom]').trim();
      const lieu = (el('lieu').value || '[Ville / Lieu de travail / Ã‰tablissement]').trim();
      const contact = '[Contact (facultatif)]';
      return (
`Objet : Appel Ã  la mobilisation du 18 dÃ©cembre â€“ JournÃ©e Sans Nous : pour une grÃ¨ve solidaire et politique

Bonjour,

Je vous Ã©cris dans le cadre de la JournÃ©e Sans Nous â€“ â€œSi on sâ€™arrÃªte, tout sâ€™arrÃªte !â€, organisÃ©e le 18 dÃ©cembre 2025, Ã  lâ€™occasion de la JournÃ©e internationale des migrantÂ·eÂ·s.
 Ã€ lâ€™initiative des collectifs de personnes sans papiers, la Marche des SolidaritÃ©s appelle Ã  une grÃ¨ve gÃ©nÃ©rale solidaire Ã  lâ€™Ã©chelle nationale.
 ðŸ‘‰ Lâ€™appel complet est consultable ici : https://www.antiracisme-solidarite.org/18-d%C3%A9cembre-2025-journee-sans-nous

Je souhaite que mon lieu de travail puisse se joindre Ã  cette mobilisation historique.
 Cette journÃ©e dâ€™action me permettra de mâ€™exprimer en solidaritÃ© avec les personnes immigrÃ©es et sans papiers, qui sont mes amiÂ·es, mes voisinÂ·es et mes collÃ¨gues â€” celles et ceux qui font tourner le pays mais restent privÃ©Â·es de droits, exploitÃ©Â·es dans des conditions indignes et constamment discriminÃ©Â·es.

Aujourdâ€™hui, les politiques racistes et inhumaines menÃ©es par lâ€™Ã‰tat (rafles, enfermements en CRA, durcissement des lois sur lâ€™immigration, atteintes aux droits sociaux) ne sont pas seulement une attaque contre les personnes Ã©trangÃ¨res :
 elles fragilisent tout le socle social en remettant en cause le droit du travail, en banalisant le travail dissimulÃ© et lâ€™exploitation humaine, en organisant une mise en concurrence destructrice entre salariÃ©Â·es, et en affaiblissant la solidaritÃ© collective.
 Ces atteintes participent Ã  un glissement gÃ©nÃ©ral vers une sociÃ©tÃ© dâ€™inÃ©galitÃ©s et de peur, oÃ¹ les droits fondamentaux de chacun deviennent nÃ©gociables.

Face Ã  cette urgence, nous avons besoin que les syndicats prennent position et ouvrent la voie Ã  une grÃ¨ve politique et solidaire, comme ils lâ€™ont dÃ©jÃ  fait dans lâ€™histoire pour des causes universelles :
 contre la guerre dâ€™AlgÃ©rie, pour les droits civiques, pour la rÃ©gularisation des sans-papiers, ou pour la dÃ©fense des libertÃ©s publiques.

ðŸ‘‰ Je vous demande :

â€¢ de vous prononcer publiquement en faveur de la JournÃ©e Sans Nous,
â€¢ dâ€™informer vos adhÃ©rentÂ·es et salariÃ©Â·es sur la possibilitÃ© de se mobiliser le 18 dÃ©cembre,
â€¢ et de mettre en Å“uvre les moyens lÃ©gaux pour permettre une grÃ¨ve solidaire (prÃ©avis, communication, appui logistiqueâ€¦).

Cette journÃ©e sera lâ€™occasion de manifester, dÃ©battre, fermer symboliquement nos lieux de travail, dâ€™enseignement ou dâ€™activitÃ©, pour rappeler que la solidaritÃ© nâ€™a pas de papiers et que la sociÃ©tÃ© ne fonctionne que grÃ¢ce Ã  celles et ceux quâ€™on invisibilise.

https://www.antiracisme-solidarite.org/18-d%C3%A9cembre-2025-journee-sans-nous

Merci pour votre Ã©coute et pour lâ€™engagement que vous prendrez.
 Je reste Ã  votre disposition pour toute information complÃ©mentaire ou pour participer Ã  lâ€™organisation locale.

Solidairement,

${nom}
 ${lieu}
 ${contact}
`)};

    const MODELE_PREAVIS = "Pour la JournÃ©e Sans Nous Ã  lâ€™occasion de la JournÃ©e internationale des Migrant.e.s 2025, nous appelons Ã  une journÃ©e de grÃ¨ve pour exiger [revendication professionnelle claire, ex : rÃ©gularisation par le travail / fin des contrÃ´les discriminatoires / protection juridique pour travailleursÂ·ses migrantÂ·es] et pour dÃ©noncer le racisme dâ€™Ã‰tat qui nie ces droits.";

    // --- Remplissage du modÃ¨le officiel ---
    function chargerModele(){ el('message').value = MODELE_OFFICIEL(); apercu(); }
    function apercu(){ el('preview').textContent = el('message').value || 'Aucun message saisi.'; }
    function copier(){ navigator.clipboard.writeText(el('message').value).then(()=>alert('Message copiÃ© dans le presseâ€‘papiers.')); }

    // --- Mailto & tÃ©lÃ©chargement ---
    function toMailto(){
      const to = el('destinataire').value || '';
      const cc = el('cc').value || '';
      const sujet = el('sujet').value || 'Appel Ã  la mobilisation du 18 dÃ©cembre â€“ JournÃ©e Sans Nous : pour une grÃ¨ve solidaire et politique';
      const body = el('message').value || MODELE_OFFICIEL();
      const enc = s => encodeURIComponent(s).replace(/%0A/g,'%0D%0A');
      const url = `mailto:${encodeURIComponent(to)}?subject=${enc(sujet)}&body=${enc(body)}${cc?`&cc=${encodeURIComponent(cc)}`:''}`;
      window.location.href = url;
    }
    function telecharger(){
      const blob = new Blob([el('message').value || MODELE_OFFICIEL()], {type:'text/plain'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'mail-pour-syndicat.txt';
      a.click();
      URL.revokeObjectURL(a.href);
    }

    // --- Base d'emails (JSON optionnel) ---
    let DB = {};
    async function loadDB(){
      try{
        const res = await fetch('./data/emails-syndicats.json',{cache:'no-store'});
        if(!res.ok) throw new Error('no db');
        DB = await res.json();
      }catch(e){ DB = {}; }
      fillSyndicats();
    }

    function fillSyndicats(){
      const s = el('syndicat'); s.innerHTML = '';
      const opt0 = document.createElement('option'); opt0.value=''; opt0.textContent='â€” choisir â€”'; s.appendChild(opt0);
      const keys = Object.keys(DB).sort();
      if(keys.length===0){
        ['CGT','Solidaires','FSU','CFDT','UNSA','CNT','FO'].forEach(k=>{
          const o=document.createElement('option');o.textContent=k;o.value=k;s.appendChild(o);
        });
      }else{
        keys.forEach(k=>{const o=document.createElement('option');o.textContent=k;o.value=k;s.appendChild(o);});
      }
      fillStructures();
    }

    function fillStructures(){
      const synd = el('syndicat').value;
      const t = el('structure'); t.innerHTML='';
      const opt0 = document.createElement('option'); opt0.value=''; opt0.textContent='â€” section / territoire â€”'; t.appendChild(opt0);
      if(DB[synd] && Array.isArray(DB[synd].sections)){
        DB[synd].sections.forEach(rec=>{
          const o=document.createElement('option'); o.value=rec.email||''; o.textContent=rec.label||rec.email; t.appendChild(o);
        });
        if(DB[synd].national){
          const o=document.createElement('option'); o.value=DB[synd].national; o.textContent=`${synd} â€” National (${DB[synd].national})`;
          t.insertBefore(o, t.children[1]);
        }
      }
      el('destinataire').value='';
    }

    // Quand on choisit une structure, on prÃ©-remplit l'email
    el('structure').addEventListener('change',()=>{
      const v = el('structure').value; if(v) el('destinataire').value = v;
    });
    el('syndicat').addEventListener('change', fillStructures);

    // Boutons
    el('btnRemplir').addEventListener('click', chargerModele);
    el('btnApercu').addEventListener('click', apercu);
    el('btnCopier').addEventListener('click', copier);
    el('btnMailto').addEventListener('click', toMailto);
    el('btnTelecharger').addEventListener('click', telecharger);
    el('btnPreavis').addEventListener('click', ()=>{navigator.clipboard.writeText(MODELE_PREAVIS).then(()=>alert('ModÃ¨le de prÃ©avis copiÃ©.'))});
    el('btnReload').addEventListener('click', loadDB);

    // Init
    document.addEventListener('DOMContentLoaded', ()=>{ loadDB(); chargerModele(); });
  </script>
</body>
</html>
